/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Element","sap/ui/core/InvisibleText","sap/ui/core/Renderer","sap/ui/core/IconPool","sap/ui/core/library","sap/ui/core/Lib","sap/ui/events/KeyCodes","sap/ui/util/openWindow","sap/ui/util/defaultLinkTypes","./NavigationListItemBase"],function(e,t,s,i,n,o,r,a,l,p,c){"use strict";var g=o.TextAlign;var d=o.TextDirection;var u=e.NavigationListItemDesign;var f=o.aria.HasPopup;const h="sap-icon://navigation-right-arrow";const I="sap-icon://navigation-down-arrow";const L=c.extend("sap.tnt.NavigationListItem",{metadata:{library:"sap.tnt",properties:{icon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},visible:{type:"boolean",group:"Appearance",defaultValue:true},selectable:{type:"boolean",group:"Behavior",defaultValue:true},href:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},target:{type:"string",group:"Behavior",defaultValue:null},design:{type:"sap.tnt.NavigationListItemDesign",group:"Behavior",defaultValue:u.Default},ariaHasPopup:{type:"sap.ui.core.aria.HasPopup",group:"Accessibility",defaultValue:f.None}},defaultAggregation:"items",aggregations:{items:{type:"sap.tnt.NavigationListItem",multiple:true,singularName:"item"}},events:{select:{parameters:{item:{type:"sap.ui.core.Item"}}}},designtime:"sap/tnt/designtime/NavigationListItem.designtime"}});L._getInvisibleText=function(){if(!this._invisibleText){this._invisibleText=(new s).toStatic();this._invisibleText.setText(r.getResourceBundleFor("sap.tnt").getText("NAVIGATION_LIST_EXTERNAL_LINK_DESCRIPTION"))}return this._invisibleText};L.prototype.createListForPopup=function(){const e=this.getItems(),t=this.getNavigationList(),s=t.getSelectedItem();let i;const n=e.filter(e=>e.getVisible()).map(e=>{const t=new L({key:e.getId(),text:e.getText(),textDirection:e.getTextDirection(),enabled:e.getEnabled(),selectable:e.getSelectable(),href:e.getHref(),target:e.getTarget(),tooltip:e.getTooltip()});if(s===e){i=t}return t});const o=new L({expanded:true,hasExpander:false,selectable:this.getSelectable(),key:this.getId(),text:this.getText(),enabled:this.getEnabled(),textDirection:this.getTextDirection(),href:this.getHref(),target:this.getTarget(),tooltip:this.getTooltip(),items:n});const r=t.getMetadata().getClass().prototype.constructor;const a=new r({itemSelect:this.onPopupItemSelect.bind(this),itemPress:this.onPopupItemPress.bind(this),items:o}).addStyleClass("sapTntNLPopup");if(s==this){i=o;a.isGroupSelected=true}a.setSelectedItem(i);return a};L.prototype.onPopupItemSelect=function(e){const s=e.getParameter("item"),i=t.getElementById(s.getKey());i._selectItem()};L.prototype.onPopupItemPress=function(e){const s=e.getParameter("item"),i=t.getElementById(s.getKey());if(!i._firePress(e,i)){e.preventDefault()}};L.prototype._selectItem=function(){const e={item:this};this.fireSelect(e);if(this.getSelectable()){this.getNavigationList()._selectItem(e)}this._openUrl()};L.prototype._openUrl=function(){const e=this.getHref();if(e){l(e,this.getTarget()||"_self")}};L.prototype.ontap=function(e){if(c.prototype.ontap.apply(this,arguments)){return}e.preventDefault();if(this.getLevel()>0){if(this.getEnabled()&&this.getAllParentsEnabled()){this._selectItem()}return}const t=this.getNavigationList();if(t.getExpanded()||!this.getItems().length){this._selectItem()}else{const e=this.createListForPopup();t._openPopover(this,e)}};L.prototype.onkeydown=function(e){if(e.isMarked("subItem")){return}if(e.key?e.key==="Enter":e.keyCode===a.ENTER){this.ontap(e)}c.prototype.onkeydown.apply(this,arguments)};L.prototype.onkeyup=function(e){if(e.isMarked("subItem")){return}if(e.key?e.key===" ":e.keyCode===a.SPACE){this.ontap(e)}if(e.srcControl.getLevel()===1){e.setMarked("subItem")}};L.prototype.render=function(e,t){if(!this.getVisible()){return}if(this.getLevel()===0){this.renderFirstLevelNavItem(e,t)}else{this.renderSecondLevelNavItem(e,t)}};L.prototype.renderFirstLevelNavItem=function(e,t){const s=this._getVisibleItems(this),i=this._isListExpanded(),n=this.getEnabled()||this.getAllParentsEnabled();e.openStart("li",this).attr("role","none");if(!i){if(s.length&&n){e.class("sapTntNLINotExpandedTriangle")}if(this._isOverflow){e.class("sapTntNLOverflow").class("sapTntNLIHidden")}}e.openEnd();const o=`${this.getId()}-subtree`;this.renderMainElement(e,t,o);if(i&&s.length){e.openStart("ul",o).class("sapTntNLIItemsContainer").accessibilityState({role:"group",label:this.getText()});if(!this.getExpanded()&&!this._animateCollapse||this._animateExpand){e.class("sapTntNLIItemsContainerHidden")}e.openEnd();s.forEach(s=>s.render(e,t));e.close("ul")}e.close("li")};L.prototype._renderExternalLinkIcon=function(e){if(!(this.getHref()&&this.getTarget()==="_blank")){return}const t=this._getExternalIcon();e.renderControl(t)};L.prototype.renderMainElement=function(e,t,s){const i=this._isListExpanded(),n=this._getVisibleItems(this),o=!this.getEnabled()||!this.getAllParentsEnabled(),r=this.getExpanded(),a=this.getSelectable(),l=this.getDesign(),p=!!n.length&&this.getHasExpander();e.openStart("div").class("sapTntNLI").class("sapTntNLIFirstLevel");if(o){e.class("sapTntNLIDisabled")}let c=false;if(a&&t._selectedItem===this){e.class("sapTntNLISelected");c=true}if((!i||!r)&&n.includes(t._selectedItem)){e.class("sapTntNLISelected");c=true}if(p){e.class("sapTntNLIWithExpander")}if(a&&n.length){e.class("sapTntNLITwoClickAreas")}const g={};if(this.getAriaHasPopup()!==f.None){g.haspopup=this.getAriaHasPopup()}if(l===u.Action){e.class("sapTntNLIAction")}if(!a){e.class("sapTntNLIUnselectable")}if(this._isInsidePopover()){e.class("sapTntNLIInPopover")}if(!i){g.role=a?"menuitemradio":"menuitem";if(n.length){g.haspopup="tree"}if(this._isOverflow){g.haspopup="menu";g.label=this._resourceBundleTnt.getText("NAVIGATION_LIST_OVERFLOW_ITEM_LABEL")}if(a){g.checked=t._selectedItem===this;g.selected=c}else{g.selected=false}g.roledescription=this._resourceBundleTnt.getText("NAVIGATION_LIST_ITEM_ROLE_DESCRIPTION_MENUITEM")}else{g.role="treeitem";if(a){g.selected=c}else{g.selected=false}if(c){g.current="page"}if(n.length){g.owns=s;g.expanded=r}}e.openEnd();this._renderStartLink(e,g,o);this._renderIcon(e);this._renderText(e);this._renderExternalLinkIcon(e);if(i){const t=this._getExpandIconControl();t.setVisible(p).setSrc(r?I:h).setTooltip(this._getExpandIconTooltip(!r));e.renderControl(t)}if(!i&&this.getItems().length){const t=this._getExpandIconControl().setSrc(h);e.renderControl(t)}this._renderCloseLink(e);e.close("div")};L.prototype.renderSecondLevelNavItem=function(e,t){const s=!this.getEnabled()||!this.getAllParentsEnabled();e.openStart("li",this).class("sapTntNLI").class("sapTntNLISecondLevel").attr("role","none");let i=false;if(this.getSelectable()&&t._selectedItem===this){e.class("sapTntNLISelected");i=true}if(s){e.class("sapTntNLIDisabled")}if(this._isInsidePopover()){e.class("sapTntNLIInPopover")}e.openEnd();const n={role:"treeitem",current:this._isListExpanded()&&i?"page":undefined,selected:i};this._renderStartLink(e,n,s);this._renderIcon(e);this._renderText(e);this._renderExternalLinkIcon(e);this._renderCloseLink(e);e.close("li")};L.prototype._renderStartLink=function(e,t,s){const i=this.getHref(),n=this.getTarget();e.openStart("a",`${this.getId()}-a`).accessibilityState(this,{...t});const o=this.getTooltip_AsString()||this.getText();if(o){e.attr("title",o)}if(s){e.attr("aria-disabled","true")}e.attr("tabindex","-1");if(i){e.attr("href",i)}if(n){e.attr("target",n).attr("rel",p("",n))}if(i&&n==="_blank"){const t=L._getInvisibleText();e.attr("aria-describedby",t.getId())}e.openEnd()};L.prototype._renderCloseLink=function(e){e.close("a")};L.prototype._renderIcon=function(e){const t=this.getIcon(),s=n.getIconInfo(t);e.openStart("span").class("sapUiIcon").class("sapTntNLIIcon").attr("aria-hidden","true");if(t){if(s&&!s.suppressMirroring){e.class("sapUiIconMirrorInRTL")}if(s){e.attr("data-sap-ui-icon-content",s.content).style("font-family",`'${s.fontFamily}'`)}}e.openEnd().close("span")};L.prototype._renderText=function(e){e.openStart("span").class("sapMText").class("sapTntNLIText").class("sapMTextNoWrap");const t=this.getTextDirection();if(t!==d.Inherit){e.attr("dir",t.toLowerCase())}const s=i.getTextAlign(g.Begin,t);if(s){e.style("text-align",s)}e.openEnd().text(this.getText()).close("span")};L.prototype._toggle=function(e){const t=this.getNavigationList(),s=this._isListExpanded();if(!t||!t.getDomRef()){return}const i=this.getDomRef();if(this.getLevel()===0){const t=i?.querySelector(".sapTntNLIFirstLevel");t?.classList.toggle("sapTntNLISelected",e)}if(this.getLevel()!==0){if(s){i?.classList.toggle("sapTntNLISelected",e)}else{const t=this.getParent().getDomRef()?.querySelector(".sapTntNLIFirstLevel");t?.classList.toggle("sapTntNLISelected",e);if(e){t?.classList.toggle("sapTntNLINoHoverEffect",e)}}}this._syncAriaAttributes(this.getFocusDomRef(),e,s);t._closePopover()};L.prototype._syncAriaAttributes=function(e,t,s){if(!e){return}if(s){if(t){e.setAttribute("aria-current","page");e.setAttribute("aria-selected","true")}else{e.removeAttribute("aria-current");e.setAttribute("aria-selected","false")}}else{e.setAttribute("aria-checked",t?"true":"false")}};L.prototype._getFocusDomRefs=function(){const e=[];if(!this.getVisible()){return e}if(!this._isInsidePopover()||this.getSelectable()&&this.getLevel()===0){e.push(this.getDomRef("a"))}if(this._isListExpanded()&&this.getExpanded()){e.push(...this.getDomRef().querySelectorAll(".sapTntNLISecondLevel a"))}return e};L.prototype._getVisibleItems=function(e){return e.getItems().filter(e=>e.getVisible())};L.prototype.onclick=function(e){if(this.getHref()){e.preventDefault()}};L.prototype.onmousedown=function(e){if(this.getHref()){e.preventDefault()}};L.prototype.onfocusout=function(){var e=this.getDomRef()?.querySelector(".sapTntNLIFirstLevel");if(e){e.classList.remove("sapTntNLINoHoverEffect")}};L.prototype.onmouseout=function(){const e=this.getDomRef()?.querySelector(".sapTntNLIFirstLevel");const t=this.getNavigationList();const s=this.getItems().find(e=>e===t.getSelectedItem());if(e&&(this===t.getSelectedItem()||s)){e.classList.add("sapTntNLINoHoverEffect")}};L.prototype.onmouseover=L.prototype.onfocusout;return L});
//# sourceMappingURL=NavigationListItem.js.map