/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Lib","sap/ui/core/Theming","sap/ui/core/Element","sap/ui/core/Control","sap/ui/core/ResizeHandler","sap/ui/core/Popup","sap/m/library","sap/m/Popover","sap/ui/core/delegate/ItemNavigation","sap/ui/core/InvisibleText","./NavigationListItem","./NavigationListMenuItem","./NavigationListRenderer","sap/m/Menu","sap/base/Log"],function(e,t,i,o,s,n,a,r,p,l,d,g,c,m,f,u){"use strict";var h=r.PlacementType;const _=s.extend("sap.tnt.NavigationList",{metadata:{library:"sap.tnt",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension"},expanded:{type:"boolean",group:"Misc",defaultValue:true},selectedKey:{type:"string",group:"Data"}},defaultAggregation:"items",aggregations:{items:{type:"sap.tnt.NavigationListItemBase",multiple:true,singularName:"item"},_overflowItem:{type:"sap.tnt.NavigationListItem",multiple:false,visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},selectedItem:{type:"sap.tnt.NavigationListItem",multiple:false}},events:{itemSelect:{parameters:{item:{type:"sap.ui.core.Item"}}},itemPress:{allowPreventDefault:true,parameters:{item:{type:"sap.ui.core.Item"},ctrlKey:{type:"boolean"},shiftKey:{type:"boolean"},altKey:{type:"boolean"},metaKey:{type:"boolean"}}}}},renderer:m});_.prototype.init=function(){this._oItemNavigation=new l;this._oItemNavigation.setCycling(false).setPageSize(10).setDisabledModifiers({sapnext:["alt","meta"],sapprevious:["alt","meta"]});this.addDelegate(this._oItemNavigation);this._handleThemeAppliedBound=this._handleThemeApplied.bind(this)};_.prototype.exit=function(){if(this._oItemNavigation){this.removeDelegate(this._oItemNavigation);this._oItemNavigation.destroy();this._oItemNavigation=null}if(this._oPopover){this._oPopover.destroy();this._oPopover=null}this._deregisterResizeHandler();i.detachApplied(this._handleThemeAppliedBound)};_.prototype.onBeforeRendering=function(){this._deregisterResizeHandler();const e=this.getSelectedKey();this.setSelectedKey(e)};_.prototype.onAfterRendering=function(){this._oItemNavigation.setRootDomRef(this.getDomRef());this._animateExpandCollapse();this._updateNavItems();if(this.getExpanded()){return}this.getDomRef().scrollTop=0;this._sResizeListenerId=n.register(this.getDomRef().parentNode,this._resize.bind(this));i.attachApplied(this._handleThemeAppliedBound)};_.prototype._animateExpandCollapse=function(){const e=this.getItems().flatMap(e=>[e,...e.getItems()]);const t=e.find(e=>e._animateExpand);if(t){t._animateExpand=false;t.$().find(".sapTntNLIItemsContainer").first().stop(true,true).slideDown("fast",()=>{t.$().find(".sapTntNLIItemsContainer").first().removeClass("sapTntNLIItemsContainerHidden")})}const i=e.find(e=>e._animateCollapse);if(i){i._animateCollapse=false;i.$().find(".sapTntNLIItemsContainer").first().stop(true,true).slideUp("fast",()=>{i.$().find(".sapTntNLIItemsContainer").first().addClass("sapTntNLIItemsContainerHidden")})}};_.prototype._deregisterResizeHandler=function(){if(this._sResizeListenerId){n.deregister(this._sResizeListenerId);this._sResizeListenerId=null}};_.prototype._handleThemeApplied=function(){i.detachApplied(this._handleThemeAppliedBound);this._updateOverflowItems()};_.prototype._resize=function(){this._updateOverflowItems()};_.prototype._updateOverflowItems=function(){var e=this.getDomRef();if(this.getExpanded()||!e){return}const t=e.querySelector(".sapTntNLOverflow");if(!t){return}t.classList.add("sapTntNLIHidden");const i=[...e.querySelectorAll("ul > :not(.sapTntNLOverflow)")];let o=i.reduce((e,t)=>{t.classList.remove("sapTntNLIHidden");return e+t.offsetHeight},0);const{paddingTop:s,paddingBottom:n}=window.getComputedStyle(e);const a=e.offsetHeight-parseFloat(s)-parseFloat(n);if(a>=o){return}t.classList.remove("sapTntNLIHidden");o=t.offsetHeight;let r=e.querySelector(".sapTntNLISelected");if(r){r=r.parentNode;const{marginTop:e,marginBottom:t}=window.getComputedStyle(r);o+=r.offsetHeight+parseFloat(e)+parseFloat(t)}i.forEach(e=>{if(e===r){return}const{marginTop:t,marginBottom:i}=window.getComputedStyle(e);o+=e.offsetHeight+parseFloat(t)+parseFloat(i);if(o>=a){e.classList.add("sapTntNLIHidden")}})};_.prototype._getOverflowItem=function(){let e=this.getAggregation("_overflowItem");if(!e){e=new g({text:t.getResourceBundleFor("sap.tnt").getText("NAVIGATION_LIST_NAVIGATION_OVERFLOW"),icon:"sap-icon://overflow",selectable:false,select:this._overflowPress.bind(this)});e._isOverflow=true;this.setAggregation("_overflowItem",e)}return e};_.prototype._overflowPress=function(e){const t=e.getSource();t.getDomRef().querySelector(".sapTntNLI").classList.add("sapTntNLIActive");const i=this._createOverflowMenu(t);const o=i._getPopover();o.setPlacement(h.Right);i.openBy(t,false,a.Dock.EndCenter)};_.prototype._createOverflowMenu=function(e){const t=new f({closed:function(){e.getDomRef().querySelector(".sapTntNLI").classList.remove("sapTntNLIActive")}});t.applySettings({items:this._createNavigationMenuItems(t)});t.addStyleClass("sapTntNLMenu");this.addDependent(t);return t};_.prototype._createNavigationMenuItems=function(e){var t=[],i=[];this.getItems().forEach(e=>{if(e.isA("sap.tnt.NavigationListGroup")){t.push(...e.getItems())}else{t.push(e)}});t.forEach(function(t){if(!t.getVisible()||!t.getDomRef().classList.contains("sapTntNLIHidden")){return}var o=new c({icon:t.getIcon(),text:t.getText(),tooltip:t.getTooltip_AsString()||t.getText(),visible:t.getVisible(),enabled:t.getEnabled(),href:t.getHref(),target:t.getTarget()});o._navItem=t;o._oMenu=e;t.getItems().forEach(function(t){var i=new c({icon:t.getIcon(),text:t.getText(),tooltip:t.getTooltip_AsString()||t.getText(),visible:t.getVisible(),enabled:t.getEnabled(),href:t.getHref(),target:t.getTarget()});i._navItem=t;i._oMenu=e;o.addItem(i)});i.push(o)});return i};_.prototype._updateNavItems=function(){const e=this._getFocusDomRefs();this._oItemNavigation.setItemDomRefs(e)};_.prototype._getFocusDomRefs=function(){const e=this.getItems().flatMap(e=>e._getFocusDomRefs()),t=this._getOverflowItem().getDomRef("a");if(!this.getExpanded()&&t){e.push(t)}return e};_.prototype._adaptPopoverPositionParams=function(){if(this.getShowArrow()){this._marginLeft=10;this._marginRight=10;this._marginBottom=10;this._arrowOffset=8;this._offsets=["0 -8","8 0","0 8","-8 0"];this._myPositions=["center bottom","begin top","center top","end top"];this._atPositions=["center top","end top","center bottom","begin top"]}else{this._marginTop=0;this._marginLeft=0;this._marginRight=0;this._marginBottom=0;this._arrowOffset=0;this._offsets=["0 0","0 0","0 0","0 0"];this._myPositions=["begin bottom","begin top","begin top","end top"];this._atPositions=["begin top","end top","begin bottom","begin top"]}};_.prototype._selectItem=function(e){this.fireItemSelect(e);this.setSelectedItem(e.item)};_.prototype._findItemByKey=function(e){const t=this.findAggregatedObjects(true,e=>e.isA("sap.tnt.NavigationListItem"));return t.find(t=>t._getUniqueKey()===e)};_.prototype.setSelectedKey=function(e){const t=this._findItemByKey(e);this.setSelectedItem(t);return this.setProperty("selectedKey",e,true)};_.prototype.getSelectedItem=function(){return o.getElementById(this.getAssociation("selectedItem"))||null};_.prototype.setSelectedItem=function(e){let t;if(this._selectedItem){this._selectedItem._toggle(false)}if(!e){this._selectedItem=null}const i=e&&e.isA&&e.isA("sap.tnt.NavigationListItem");if(typeof e!="string"&&!i){this.setAssociation("selectedItem",null,true);this._updateOverflowItems();e=null}this.setAssociation("selectedItem",e,true);if(typeof e=="string"){t=o.getElementById(e)}else if(i){t=e}else{u.warning("Type of selectedItem association should be a valid NavigationListItem object or ID. New value was not set.");return this}this.setProperty("selectedKey",t._getUniqueKey(),true);t._toggle(true);this._selectedItem=t;this._updateOverflowItems();return this};_.prototype._openPopover=function(e,t){const i=e.getDomRef().querySelector(".sapTntNLI");i.classList.add("sapTntNLIActive");let o=t.getSelectedItem();if(o&&t.isGroupSelected){o=null}if(this._oPopover){this._oPopover.destroy()}this._oPopover=new p({showHeader:false,horizontalScrolling:false,verticalScrolling:true,initialFocus:o,afterClose:()=>{if(this._oPopover){this._oPopover.destroy();this._oPopover=null;i.classList.remove("sapTntNLIActive")}},content:t,ariaLabelledBy:d.getStaticId("sap.tnt","NAVIGATION_LIST_DIALOG_TITLE")}).addStyleClass("sapContrast sapContrastPlus sapTntNLPopover");this.addDependent(this._oPopover);this._oPopover._adaptPositionParams=this._adaptPopoverPositionParams;this._oPopover.openBy(e.getDomRef("a"))};_.prototype._closePopover=function(){if(this._oPopover){this._oPopover.close()}};_.prototype._containsIcon=function(){const e=this.findAggregatedObjects(true,e=>e.isA("sap.tnt.NavigationListItem")&&!e._isOverflow&&e.getProperty("icon"));return!!e.length};return _});
//# sourceMappingURL=NavigationList.js.map